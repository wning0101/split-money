(this.webpackJsonpsplit_money=this.webpackJsonpsplit_money||[]).push([[0],{18:function(e,t,a){e.exports=a(27)},23:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(12),l=a(16),s=a(13),m=a(3),i=a(17),c=a(0),d=a.n(c),u=a(14),o=a.n(u);a(23);var h=function(e){return d.a.createElement("div",null,d.a.createElement("li",null," ",e.name,": ",e.balance," "))};var p=function(e){for(var t=" ",a=0;a<e.share.length;a++)t+=e.share[a]+", ";var n=t.length;return t=t.substring(0,n-2),d.a.createElement("li",null,e.pay," paid $",e.amount," for ",e.sub," [",t,"] ")};var E=function(e){return d.a.createElement("option",{value:e.name}," ",e.name," ")};var b=function(e){return d.a.createElement("div",null,d.a.createElement("input",{id:e.name,type:"checkbox",name:e.name})," ",e.name)};var v=function(e){return d.a.createElement("li",null," ",e.give," gives ",e.recieve," ",e.amount," dollars. ")};var _=function(e){return""==e.email||""==e.password?d.a.createElement(d.a.Fragment,null,d.a.createElement("p",null," Email: ")," ",d.a.createElement("input",{id:"email_l"}),d.a.createElement("p",null," password: ")," ",d.a.createElement("input",{id:"password_l"}),d.a.createElement("button",{onClick:e.login},"Login")):d.a.createElement("a",null," Hello, ",e.name)},g=a(8);var f=function(e){return""==e.email||""==e.password?d.a.createElement(d.a.Fragment,null,d.a.createElement("p",null," Name: ")," ",d.a.createElement("input",{id:"name_r"}),d.a.createElement("p",null," Email: ")," ",d.a.createElement("input",{id:"email_r"}),d.a.createElement("p",null," password: ")," ",d.a.createElement("input",{id:"password_r"}),d.a.createElement("button",{onClick:e.register},"Register")):d.a.createElement("a",null)},y=a(7),w=a.n(y),k=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(l.a)(this,Object(s.a)(t).call(this))).add_member=function(){var t=e.state.each_spend,a=e.state.each_share,n=e.state.members,r=String(document.getElementById("name").value);""!=r?e.state.members.includes(r)?alert(r+" already exists"):(n.push(r),t[r]=Number(0),a[r]=Number(0),e.setState({number:e.state.number+1,members:n,each_spend:t,each_share:a}),e.update_data()):alert("Please don't enter empty name")},e.add_spending=function(){var t=String(document.getElementById("payer").value),a=document.getElementById("amount").value;if(a<=0)alert("The amount can't be equal or less than zero.");else{var n=String(document.getElementById("subject").value);if(""!=n){var r=[],l=0;for(l=0;l<e.state.members.length;l++)1==document.getElementById(String(e.state.members[l])).checked&&r.push(e.state.members[l]);var s=r.length;if(0!=s){var m=e.state.each_share,i=e.state.each_spend;for(i[t]=Number(i[t])+Number(a),l=0;l<s;l++)m[r[l]]+=a/s;var c=e.state.record;c.push([t,a,r,n]),e.setState({total_spend:e.state.total_spend+a,each_share:m,each_spend:i,record:c}),e.settle(),e.update_data()}else alert("There's no sharer.")}else alert("Empty subject.")}},e.help_login=function(){e.displayTodos(document.getElementById("email_l").value,document.getElementById("password_l").value)},e.help_register=function(){var t=w.a.create();t.update(document.getElementById("password_r").value+"$@^%$qwd"),e.db.collection("SP").findOne({owner_id:document.getElementById("email_r").value}).then((function(a){null!=a?alert("This email is already registered."):(e.db.collection("SP").insertOne({owner_id:document.getElementById("email_r").value,password:t.hex(),name:document.getElementById("name_r").value,data:{owner:document.getElementById("email_r").value,name:document.getElementById("name_r").value,password:t.hex(),number:0,total_spend:0,members:[],result:[],record:[],each_spend:{},each_share:{}}}).then(),alert("Register Successfully."))}))},e.state={owner:"",name:"",password:"",number:0,total_spend:0,members:[],result:[],record:[],each_spend:{},each_share:{}},e.add_member=e.add_member.bind(Object(m.a)(e)),e.add_spending=e.add_spending.bind(Object(m.a)(e)),e.settle=e.settle.bind(Object(m.a)(e)),e.displayTodos=e.displayTodos.bind(Object(m.a)(e)),e.help_login=e.help_login.bind(Object(m.a)(e)),e}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.client=g.b.initializeDefaultAppClient("split-money-filxi");var e=this.client.getServiceClient(g.a.factory,"mongodb-atlas");this.db=e.db("SP")}},{key:"displayTodos",value:function(e,t){var a=this,n=w.a.create();n.update(t+"$@^%$qwd"),this.db.collection("SP").findOne({owner_id:e,password:n.hex()}).then((function(e){return null==e?(alert("Invalid login. Please check your email and password."),!1):(a.setState({owner:e.data.owner,password:e.data.password,name:e.data.name,number:e.data.number,total_spend:e.data.total_spend,members:e.data.members,result:e.data.result,record:e.data.record,each_spend:e.data.each_spend,each_share:e.data.each_share}),e)}))}},{key:"update_data",value:function(){this.db.collection("SP").updateOne({owner_id:this.state.owner,password:this.state.password},{$set:{data:this.state}})}},{key:"add_data",value:function(){this.db.collection("SP").insertOne({owner_id:document.getElementById("email_r").value,password:document.getElementById("password_r").value,name:document.getElementById("name_r").value,data:[this.state]}).then()}},{key:"settle",value:function(){var e=[],t=[],a=[],n=[],r=0;for(r=0;r<this.state.members.length;r++){var l=this.state.members[r],s=this.state.each_spend[l]-this.state.each_share[l];s>0?e.push([s,l]):s<0?t.push([s,l]):a.push([0,l])}function m(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}function i(e,t){return e[0]<t[0]?1:e[0]>t[0]?-1:0}e=e.sort(m),t=t.sort(i);for(var c=[];e.length>0&&t.length>0;){var d=e[0][0]+t[0][0];d>0?(n.push([t[0][1],e[0][1],-t[0][0]]),e[0][0]+=t[0][0],c=[e[0][0],e[0][1]],e.shift(),t.shift(),e.push(c),e=e.sort(m)):d<0?(n.push([t[0][1],e[0][1],e[0][0]]),t[0][0]+=e[0][0],c=[t[0][0],t[0][1]],e.shift(),t.shift(),t.push(c),t=t.sort(i)):(n.push([t[0][1],e[0][1],e[0][0]]),e.shift(),t.shift())}this.setState({result:n})}},{key:"login",value:function(){return d.a.createElement(_,{key:this.state.owner,email:this.state.owner,password:this.state.password,name:this.state.name,login:this.help_login})}},{key:"register",value:function(){return d.a.createElement(f,{key:this.state.owner,email:this.state.owner,password:this.state.password,register:this.help_register})}},{key:"render",value:function(){var e=this,t=this.state.members.map((function(t){return d.a.createElement(h,{key:t,name:t,balance:e.state.each_spend[t]-e.state.each_share[t]})})),a=this.state.record.map((function(e){return d.a.createElement(p,{key:e,pay:e[0],amount:e[1],share:e[2],sub:e[3]})})),n=this.state.members.map((function(e){return d.a.createElement(E,{key:e,name:e})})),r=this.state.members.map((function(e){return d.a.createElement(b,{key:e,name:e})})),l=this.state.result.map((function(e){return d.a.createElement(v,{key:e,give:e[0],recieve:e[1],amount:e[2]})})),s=this.login(),m=this.register();return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{class:"row"},d.a.createElement("div",{class:"col-sm-6"},s),d.a.createElement("div",{class:"col-sm-6"},m)),d.a.createElement("div",{class:"row"},d.a.createElement("div",{class:"col-sm-4"},d.a.createElement("a",null,"Add a new member: "),d.a.createElement("input",{id:"name"}),d.a.createElement("button",{onClick:this.add_member},"Add"),d.a.createElement("br",null)),d.a.createElement("div",{class:"col-sm-4"},d.a.createElement("a",null,"Add a new spending"),d.a.createElement("br",null),"Subject: ",d.a.createElement("br",null),d.a.createElement("input",{id:"subject"})," ",d.a.createElement("br",null),"Payer:",d.a.createElement("select",{id:"payer"},n)," ",d.a.createElement("br",null)),d.a.createElement("div",{class:"col-sm-4"},d.a.createElement("a",null," "),d.a.createElement("br",null),"Sharer:",d.a.createElement("div",{id:"sharer"},r),"Amount:",d.a.createElement("input",{id:"amount"}),d.a.createElement("br",null),d.a.createElement("button",{onClick:this.add_spending},"Add"),d.a.createElement("br",null))),d.a.createElement("div",{class:"row"},d.a.createElement("div",{class:"col-sm-4"},d.a.createElement("a",null," Members: "),d.a.createElement("div",null," ",t," ")),d.a.createElement("div",{class:"col-sm-4"},d.a.createElement("a",null," Spending Record: "),d.a.createElement("div",null," ",a)),d.a.createElement("div",{class:"col-sm-4"},d.a.createElement("a",null," Final Settle: "),d.a.createElement("div",null," ",l))))}}]),t}(d.a.Component);o.a.render(d.a.createElement(k,null),document.getElementById("note"))}},[[18,1,2]]]);
//# sourceMappingURL=main.8d945486.chunk.js.map